"use strict";(function(a,b){'use strict';// --- Toggle Submit Button ---
function c(){var a=!1;a=l.hidden?Array.from(b.getElementsByName("source-name")).some(function(a){return!!a.value}):!p.badCommas.test(l.value),j.generate.disabled=!(a&&(j["final-mugs"].checked||j.premade.checked))}// --- Add/Delete Source Text Fields ---
function d(){k.removeChild(this.parentElement),c()}function e(a){var c=b.createElement("span"),d=b.createElement("input"),e=b.createElement("input");return d.type="text",d.name="source-name",d.value=a||"",d.maxLength=51,d.placeholder="Type source name here",e.type="button",e.name=e.value="remove",e.className="material-icons",e.title="Delete this source",c.appendChild(d),c.appendChild(e),c}function f(){var a=e(m.value);m.value="",m.focus(),k.insertBefore(a,m.parentElement.nextElementSibling)}// --- Build Source Super ---
function g(a,b,c,d){return b?"Source":c?"_":d?"and":void 0}function h(a){var c=b.createElement("canvas"),d=c.getContext("2d");c.width=1280,c.height=720,d.globalCompositeOperation="destination-over",d.fillStyle="#ffffff",d.font="25px Gotham",d.textAlign="center",d.fillText(a,640,684);var e=Math.max(330,d.measureText(a).width+40);return d.fillStyle="rgba(0, 0, 0, 0.4)",d.fillRect(640-e/2,659,e,33),{name:a.replace(p.badChars,g),url:c.toDataURL()}}// --- Tabbed Browsing ---
function i(c){9===c.keyCode&&(b.body.className="accessible",a.removeEventListener("keydown",i))}var j=b.forms[0],k=j[2],l=j[3],m=j[4],n=j.prefix,o=[],p={badCommas:/^(\s*\,*)+$/,badName:/(^\s*((source:)|(courtesy:))?\s*)|(\s*$)/ig,badChars:/(^Source:)|([\/\\\<\>\"\:])|(\&)/g};k.addEventListener("input",c),j.options.addEventListener("change",c),k.addEventListener("click",function(a){"add"===a.target.name&&f(),"remove"===a.target.name&&d.call(a.target)}),m.addEventListener("keydown",function(a){13===a.keyCode&&f()}),j["mode-switch"].addEventListener("click",// --- Toggle Paste Mode --- 
function(){var a=!l.hidden,b="".concat(a?"Paste":"Entry"," Mode");l.hidden=a,this.value=b,this.title="Switch to ".concat(b);var d=a?m:l;d.focus(),c()}),j.onsubmit=function(){var a=[],c=[];return j.classList.add("loading"),l.hidden?b.getElementsByName("source-name").forEach(function(b){a.push(b.value)}):a=l.value.split(/\s*,\s*/),a=a.filter(function(a){return a}),a.some(function(a){return /^\s*courtesy:\s*/i.test(a)})&&(c=1<a.length?["One or more of your sources begin","These"]:["Your source begins","This"],c.push(n.checked?"replaced with \"Source:\"":"deleted"),!confirm("".concat(c[0]," with \"Courtesy:\" which is not permitted. ").concat(c[1]," will be ").concat(c[2],".")))?(j.classList.remove("loading"),!1):void(a.forEach(function(a){a=a.replace(p.badName,"").slice(0,51),o.push(h(n.checked?"Source: ".concat(a):a))}),j.dataURL.value=JSON.stringify(o))},a.addEventListener("keydown",i)})(window,document);
